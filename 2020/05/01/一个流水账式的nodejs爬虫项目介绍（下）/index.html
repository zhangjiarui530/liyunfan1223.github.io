<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="nodejs,web,作业," />










<meta name="description" content="好像不管怎么写都没法摆脱它流水账的本质，所以，我摊牌了。">
<meta property="og:type" content="article">
<meta property="og:title" content="一个nodejs爬虫项目介绍（下）">
<meta property="og:url" content="http://example.com/2020/05/01/%E4%B8%80%E4%B8%AA%E6%B5%81%E6%B0%B4%E8%B4%A6%E5%BC%8F%E7%9A%84nodejs%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%EF%BC%88%E4%B8%8B%EF%BC%89/index.html">
<meta property="og:site_name" content="MorphLing&#39;s Blog">
<meta property="og:description" content="好像不管怎么写都没法摆脱它流水账的本质，所以，我摊牌了。">
<meta property="og:locale">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200501203121692.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200501203232167.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200501203239314.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200501203202502.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200501203253383.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70">
<meta property="article:published_time" content="2020-05-01T12:57:20.000Z">
<meta property="article:modified_time" content="2021-03-13T10:36:14.915Z">
<meta property="article:author" content="Yunfan Li">
<meta property="article:tag" content="nodejs">
<meta property="article:tag" content="web">
<meta property="article:tag" content="作业">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20200501203121692.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2020/05/01/一个流水账式的nodejs爬虫项目介绍（下）/"/>





  <title>一个nodejs爬虫项目介绍（下） | MorphLing's Blog</title>
  








<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MorphLing's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">存在感是自我意识的基石</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/05/01/%E4%B8%80%E4%B8%AA%E6%B5%81%E6%B0%B4%E8%B4%A6%E5%BC%8F%E7%9A%84nodejs%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%EF%BC%88%E4%B8%8B%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MorphLing's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">一个nodejs爬虫项目介绍（下）</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-01T20:57:20+08:00">
                2020-05-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>好像不管怎么写都没法摆脱它流水账的本质，所以，我摊牌了。<br><a id="more"></a><br>目录：</p>
<ul>
<li>介绍</li>
<li>实现过程</li>
</ul>
<ol>
<li>MySQL数据库<br>1.1 MySQL结构<br>1.2 插入信息（nodejs接入MySQL）<br>1.3 操作方法（筛选、排序、统计）</li>
<li>网站搭建<br>2.1 express框架一点简单的认识<br>2.2 关于html内嵌js代码<br>2.3 使用express框架</li>
</ol>
<ul>
<li>一些坑和扩展<ul>
<li>MySQL中文乱码</li>
<li>可选搜索范围</li>
<li>日期排序</li>
</ul>
</li>
<li>最终效果、代码</li>
<li>总结<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2>接着上篇讲，下篇要介绍的是把爬取到的数据存入MySQL，利用MySQL本身的存储、查询、筛选、排序等功能实现搜索，以及搭建网站，将MySQL的功能通过网页对话框输入——网页输出的形式显式表现出来。MySQL和express框架的知识点从信息量上讲比request、cheerio等模块大得多，比如说在使用express框架时就需要同时对html和js代码都比较熟练（html中嵌入js），然而我对此基本上没啥经验。而且感觉之前的内容还是一环套一环，结果一到express框架这里就信息爆炸了orz，所以就很难像上篇一样讲得那么细致。<h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><h2 id="1-MySQL数据库"><a href="#1-MySQL数据库" class="headerlink" title="1. MySQL数据库"></a>1. MySQL数据库</h2><h3 id="1-1-MySQL结构"><a href="#1-1-MySQL结构" class="headerlink" title="1.1 MySQL结构"></a>1.1 MySQL结构<img src="https://img-blog.csdnimg.cn/20200501203121692.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></h3></li>
</ul>
<p>MySQL下可以有好几个数据库，每个数据库可以有好几个表格，表格在创建时规定了表头。这里我们可以把所有数据都存在一个表格里。</p>
<p>贴一下新闻table的创建方式。把id作为自增量和唯一量，根据需求避免重复爬取，将url也设置为唯一量。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`news`</span>(</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    <span class="string">`title`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`resource`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`author`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`content`</span> LONGTEXT,</span><br><span class="line">    <span class="string">`keywords`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`pubtime`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`fetchtime`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`url`</span> <span class="built_in">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(<span class="string">`id`</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`id_UNIQUE`</span> (<span class="string">`id`</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`url_UNIQUE`</span> (<span class="string">`url`</span>)</span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure></p>
<h3 id="1-2-插入信息"><a href="#1-2-插入信息" class="headerlink" title="1.2 插入信息"></a>1.2 插入信息</h3><p>首先在安装好MySQL模块的前提下，自己做一个模块’mysql.js’便于之后的操作。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mysql = <span class="built_in">require</span>(<span class="string">&quot;mysql&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> pool = mysql.createPool(&#123;</span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    user: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    password: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    database: <span class="string">&#x27;mycrawler1&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> query = <span class="function"><span class="keyword">function</span>(<span class="params">sql, sqlparam, callback</span>) </span>&#123;</span><br><span class="line">    pool.getConnection(<span class="function"><span class="keyword">function</span>(<span class="params">err, conn</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            callback(err, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            conn.query(sql, sqlparam, <span class="function"><span class="keyword">function</span>(<span class="params">qerr, vals, fields</span>) </span>&#123;</span><br><span class="line">                conn.release(); <span class="comment">//释放连接 </span></span><br><span class="line">                callback(qerr, vals, fields); <span class="comment">//事件驱动回调 </span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> query_noparam = <span class="function"><span class="keyword">function</span>(<span class="params">sql, callback</span>) </span>&#123;</span><br><span class="line">    pool.getConnection(<span class="function"><span class="keyword">function</span>(<span class="params">err, conn</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            callback(err, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            conn.query(sql, <span class="function"><span class="keyword">function</span>(<span class="params">qerr, vals, fields</span>) </span>&#123;</span><br><span class="line">                conn.release(); <span class="comment">//释放连接 </span></span><br><span class="line">                callback(qerr, vals, fields); <span class="comment">//事件驱动回调 </span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">exports</span>.query = query;</span><br><span class="line"><span class="built_in">exports</span>.query_noparam = query_noparam;</span><br></pre></td></tr></table></figure><br>这里规定了MySQL数据库信息，并把对MySQL的连接、释放一系列操作模块化。</p>
<p>然后在主程序里还是使用一个函数完成插入操作，将新闻内容存在info里作为参数。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Insert_into_sql</span>(<span class="params">info</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> add_sql=<span class="string">&quot;INSERT INTO news(id,title,resource,author,content,keywords,pubtime,fetchtime,url)VALUES(0,?,?,?,?,?,?,?,?)&quot;</span></span><br><span class="line">    <span class="keyword">var</span> add_sql_params=[info.title,info.resource,info.author,info.content,info.keywords,info.pubtime,info.fetchtime,info.url];</span><br><span class="line">    mysql.query(add_sql,add_sql_params,<span class="function"><span class="keyword">function</span>(<span class="params">qerr,vals,fields</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(qerr)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;新闻插入失败~&quot;</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(qerr.message,info);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;新闻插入成功~&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>这里我理解为通过js代码模拟MySQL的命令行操作。</p>
<h3 id="1-3-操作方法（筛选、排序、统计）"><a href="#1-3-操作方法（筛选、排序、统计）" class="headerlink" title="1.3 操作方法（筛选、排序、统计）"></a>1.3 操作方法（筛选、排序、统计）</h3><p>这部分其实和js无关，完全是MySQL的语法。</p>
<p>查询table中的元素，取出table中所有数据：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> [<span class="keyword">table</span>];</span><br></pre></td></tr></table></figure><br>利用like筛选，筛选标题中含有“新冠”的。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> [<span class="keyword">table</span>] <span class="keyword">where</span> title <span class="keyword">like</span>=<span class="string">&quot;%新冠%&quot;</span>;</span><br></pre></td></tr></table></figure><br>利用order by排序，根据时间升序排序。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> [<span class="keyword">table</span>] <span class="keyword">order</span> <span class="keyword">by</span> pubtime <span class="keyword">ASC</span>;//升序</span><br></pre></td></tr></table></figure><br>利用count(*)统计，统计标题含有“新冠”的新闻条数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT count(*) FROM [table] where title like&#x3D;&quot;%新冠%&quot;;</span><br></pre></td></tr></table></figure><br>具体可看：<a target="_blank" rel="noopener" href="https://www.runoob.com/mysql/mysql-tutorial.html">https://www.runoob.com/mysql/mysql-tutorial.html</a></p>
<p>这个也是网站实现查询等功能的核心部分，可以说接下来所有的操作都是围绕MySQL来进行的。而构建网站的目的就是在MySQL命令行操作和网站的图形化界面间构建一个桥梁。</p>
<h2 id="2-网站搭建"><a href="#2-网站搭建" class="headerlink" title="2. 网站搭建"></a>2. 网站搭建</h2><h3 id="2-1-express框架一点简单的认识"><a href="#2-1-express框架一点简单的认识" class="headerlink" title="2.1 express框架一点简单的认识"></a>2.1 express框架一点简单的认识</h3><p>一开始觉得网页前端和后端的交互挺难理解的。后来读了几段搭建网站的代码，感觉也可以简单理解成一个从输入到输出的过程，所有的输入包含在request里，输出则体现在response里。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ar express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;./mysql.js&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="comment">//app.use(express.static(&#x27;public&#x27;));</span></span><br><span class="line">app.get(<span class="string">&#x27;/7.03.html&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(__dirname);</span><br><span class="line">    res.sendFile(__dirname + <span class="string">&quot;/&quot;</span> + <span class="string">&quot;7.03.html&quot;</span>);<span class="comment">//__dirname就是代码所在文件夹的位置</span></span><br><span class="line">&#125;)</span><br><span class="line">app.get(<span class="string">&#x27;/7.04.html&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(__dirname + <span class="string">&quot;/&quot;</span> + <span class="string">&quot;7.04.html&quot;</span>);</span><br><span class="line">    res.sendFile(__dirname + <span class="string">&quot;/&quot;</span> + <span class="string">&quot;7.04.html&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line">app.get(<span class="string">&#x27;/process_get&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/html;charset=utf-8&#x27;</span> &#125;);</span><br><span class="line">    <span class="keyword">var</span> fetchSql = <span class="string">&quot;select url,source_name,title,author,publish_date from news where title like &#x27;%&quot;</span> +</span><br><span class="line">        req.query.title + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    mysql.query(fetchSql, <span class="function"><span class="keyword">function</span>(<span class="params">err, result, fields</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(result);</span><br><span class="line">        res.write(<span class="built_in">JSON</span>.stringify(result));</span><br><span class="line">        <span class="comment">//res.end(JSON.stringify(result));</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> server = app.listen(<span class="number">8080</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;访问地址为 http://127.0.0.1:8080/7.03.html&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>最基本的输入方式是直接访问网站所在的ip，比如在浏览器中输入 “<a href="http://127.0.0.1:8080&quot;，也可以是网页提交表单之后跳转到的指定ip，也可以是对按钮点击信息的捕获之类的。">http://127.0.0.1:8080&quot;，也可以是网页提交表单之后跳转到的指定ip，也可以是对按钮点击信息的捕获之类的。</a></p>
<p>大多数输入本身并不能直接产生一个结果（比如显示数据或者跳转到某个页面）。输入的意义是由后端定义的。后端根据输入，决定发送一张网页或者一些数据给前端，最终呈现在浏览器上，即输出。</p>
<h2 id="2-2-html嵌入js代码"><a href="#2-2-html嵌入js代码" class="headerlink" title="2.2 html嵌入js代码"></a>2.2 html嵌入js代码</h2><p>纯html页是静态的。如果想做出一些动态的功能比如搜索啊排序啊，要么在后端通过切换网页的方式实现动态，要么就是嵌入js代码，动态改变同一个页面内的html的元素（这个好像就是js最基本的用途）。</p>
<p>首先在header里面引入jQuery（对就是那个跟cheerio用法很像的）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery/3.4.1/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br></pre></td></tr></table></figure><br>引入之后就可以用$来选择html元素了，比如给某个元素加上一句话。（需要的话，在append的时候可以直接把一串html代码填进去，并将其作为html代码正常显示，看来插入之后是会重新生成页面的？）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>一段文字。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">&#x27;div&#x27;</span>).append(<span class="string">&quot;两段文字。&lt;input type=&#x27;text&#x27;&gt;&quot;</span>);</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><br>也可以获取一个input框内的信息，以按钮点击为触发（搜索功能的基本组件）<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>就是一个按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">&#x27;button&#x27;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            alert($(<span class="string">&#x27;input&#x27;</span>).val());</span></span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><br>所以具体说来cheerio相当于jQuery的一个子集，用来获取html元素（输入），而jQuery同时具备了获取、修改等等功能（输入+输出）。</p>
<p>好在jQuery起码在选择器的用法上和cheerio就是一样的，所以还蛮亲切的。当然有很多产生输出的方法就没怎么见过，但是查查手册也还算好理解。</p>
<h2 id="2-3-使用express框架"><a href="#2-3-使用express框架" class="headerlink" title="2.3 使用express框架"></a>2.3 使用express框架</h2><p>通过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">express -e search_site</span><br></pre></td></tr></table></figure><br>来搭建一个express脚手架。</p>
<p>然后看依赖项需要的模块，用npm install全部安装<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;cookie-parser&quot;: &quot;^1.4.5&quot;,</span><br><span class="line">    &quot;data-utils&quot;: &quot;0.0.2&quot;,</span><br><span class="line">    &quot;date-utils&quot;: &quot;^1.2.21&quot;,</span><br><span class="line">    &quot;debug&quot;: &quot;^2.6.9&quot;,</span><br><span class="line">    &quot;ejs&quot;: &quot;^2.7.4&quot;,</span><br><span class="line">    &quot;express&quot;: &quot;^4.17.1&quot;,</span><br><span class="line">    &quot;http-errors&quot;: &quot;^1.7.3&quot;,</span><br><span class="line">    &quot;morgan&quot;: &quot;^1.10.0&quot;,</span><br><span class="line">    &quot;mysql&quot;: &quot;^2.18.1&quot;,</span><br><span class="line">    &quot;parser&quot;: &quot;^0.1.4&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><br>然后就生成了一个好像很高级但是看不懂的文件夹结构。。</p>
<p>应该是整个项目最不理解的地方吧。</p>
<p>不过既然都说是框架了也没必要搞那么清楚了。把mysql.js放在根目录，后端index.js放在routes下，前端页面search.html放在public里面，然后需要自己做的也就是一个js和一个html。<del>其他的统统当作黑箱操作</del></p>
<p>具体代码就放在最后吧。</p>
<h2 id="一些坑和扩展"><a href="#一些坑和扩展" class="headerlink" title="一些坑和扩展"></a>一些坑和扩展</h2><h3 id="MySQL中文乱码"><a href="#MySQL中文乱码" class="headerlink" title="MySQL中文乱码"></a>MySQL中文乱码</h3><p>“众所周知，有中文的地方。。它就有乱码。”<br><img src="https://img-blog.csdnimg.cn/20200501203232167.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>不过MySQL出现乱码，一般不是爬取的数据出错，只是因为cmd编码和MySQL编码方式不匹配，这里只要统一设定为一种编码就可以了，比如utf8。</p>
<p>右键-&gt;属性-&gt;查看cmd编码，可以看到编码类型。</p>
<p><img src="https://img-blog.csdnimg.cn/20200501203239314.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>图里已经是UTF-8就不用设置了，如果是GBK或者其他类型的可以通过在命令行里输入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chcp 65001</span><br></pre></td></tr></table></figure></p>
<p>接着设置MySQL的编码，在MySQL中输入”show variables like “%char%”;”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &quot;%char%&quot;;</span><br><span class="line">+--------------------------+--------------------------+</span><br><span class="line">| Variable_name            | Value                    |</span><br><span class="line">+--------------------------+--------------------------+</span><br><span class="line">| character_set_client     | utf8mb4                  |</span><br><span class="line">| character_set_connection | utf8mb4                  |</span><br><span class="line">| character_set_database   | utf8mb4                  |</span><br><span class="line">| character_set_filesystem | binary                   |</span><br><span class="line">| character_set_results    | gbk                      |</span><br><span class="line">| character_set_server     | utf8mb4                  |</span><br><span class="line">| character_set_system     | utf8                     |</span><br><span class="line">| character_sets_dir       | c:\mysql\share\charsets\ |</span><br><span class="line">+--------------------------+--------------------------+</span><br></pre></td></tr></table></figure><br>把character_set_results也设置成UTF-8;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set character_set_results&#x3D;utf8;</span><br></pre></td></tr></table></figure><br>编码统一之后就可以正常显示了。</p>
<h3 id="可选搜索范围"><a href="#可选搜索范围" class="headerlink" title="可选搜索范围"></a>可选搜索范围</h3><p>根据MySQL功能进行的拓展，本质上就是扩展where子句之后判断方法。然而实现起来还是挺麻烦的。<br><img src="https://img-blog.csdnimg.cn/20200501203202502.png" alt="在这里插入图片描述"></p>
<p>首先用checkbox做出三个可选项，分别对应在标题、关键字、内容里面搜索。在用户点下搜索按钮时，将三个checkbox的值作为参数传给后端，并生成相应的MySQL查询命令。需要特判一下三个都没有选的情况，否则会崩溃。</p>
<p>创建三个checkbox，先判断是否都为false，再传参。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;option1&quot;</span>&gt;</span>标题</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;option2&quot;</span>&gt;</span>关键字</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;option3&quot;</span>&gt;</span>内容</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">&#x27;input.search_title&#x27;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> title=$(<span class="string">&#x27;input.option1&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> keywords=$(<span class="string">&#x27;input.option2&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> content=$(<span class="string">&#x27;input.option3&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (title.valueOf()==<span class="literal">false</span> &amp;&amp; keywords.valueOf()==<span class="literal">false</span> &amp;&amp; content.valueOf()==<span class="literal">false</span>)&#123;</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">&quot;请至少选择一项作为搜索范围~&quot;</span>);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">        $.get(<span class="string">&#x27;/process_get?title=&#x27;</span>+title+<span class="string">&#x27;&amp;keywords=&#x27;</span>+keywords+<span class="string">&#x27;&amp;content=&#x27;</span>+content+<span class="string">&#x27;&amp;sort=&#x27;</span>+sort+<span class="string">&#x27;&amp;words=&#x27;</span>+words，<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br>相对应的<del>非常朴素的</del>后端代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fetchSql = <span class="string">&quot;select id,title,keywords,url,resource,pubtime &quot;</span> + <span class="string">&quot;from news where&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> conc=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (request.query.title==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; title like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (request.query.keywords==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; keywords like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (request.query.content==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; content like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="日期排序"><a href="#日期排序" class="headerlink" title="日期排序"></a>日期排序</h3><p>跟上面那个就是一个原理。贴一下后端代码。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (request.query.sort==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        fetchSql+=<span class="string">&quot; order by pubtime ASC&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fetchSql+=<span class="string">&quot;;&quot;</span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="最终效果、代码"><a href="#最终效果、代码" class="headerlink" title="最终效果、代码"></a>最终效果、代码</h2><p><img src="https://img-blog.csdnimg.cn/20200501203253383.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vcnBoTGluZ18=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>就是能在标题、关键字、内容里面选择搜索范围，并选择是否要按日期排序，差不多上面都提到了。再加一点<del>简陋的</del>css样式就完事了。</p>
<p>后续可以做一下统计关键词热度的功能。其实本来就想做的，发现不会，就回头研究一下吧。（如果只是手动给几个关键词，统计一下出现次数还是可以的，但是没啥意义）</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总结一下就是要用的东西太多但是会的太少所以就虎头蛇尾了。后半部分基本也不是自己完整写下来的，都是照着示例和网上的代码调调改改然后弄出来一个能不崩溃的东西而已。说实话，按照以前写代码的习惯，我不太喜欢调用一些自己实现不了的模块和功能，或者起码要清楚知道它的原理才能放心用。但是这个项目做下来就感觉，如果真的要把方方面面都讲清楚，哪怕只是一个模块，都是很复杂的，像MySQL这种可能都可以专门开一节课去讲了。这也就是我在下半篇其实几乎没有对代码的解释的原因，一是确实不够了解，二是心态已经变成“无所谓，能用就行”了。当然收获也是很大的，对很多网络相关的知识以前是完全没概念，现在起码有了一点思路，同时体现在对前后端交互方式的感性认识上。</p>
<p>可能得以后自己真的要做一个网页的时候才能有更深的理解吧。但是作为作业做到这应该也差不多了，因为我高数真的要挂科了orz。</p>
<p>代码的话就贴一个爬虫的（一共有五个，对应五个新闻网）一个前端的一个后端的，比较长，后面也没东西了，所以看到这就可以结束了。</p>
<p>爬虫：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myRequest = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> myIconv = <span class="built_in">require</span>(<span class="string">&#x27;iconv-lite&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> myCheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> mysql=<span class="built_in">require</span>(<span class="string">&#x27;./mysql.js&#x27;</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;date-utils&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myURL=<span class="string">&quot;http://www.chinanews.com/&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> myResource=<span class="string">&quot;中国新闻网&quot;</span></span><br><span class="line"><span class="keyword">var</span> myEncoding=<span class="string">&#x27;UTF-8&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> newsExg=<span class="regexp">/\d&#123;4&#125;\/\d&#123;2&#125;-\d&#123;2&#125;\/\d&#123;7&#125;.shtml/</span>;</span><br><span class="line"><span class="keyword">var</span> options=&#123;</span><br><span class="line">    url:myURL,</span><br><span class="line">    encoding:<span class="literal">null</span>,</span><br><span class="line">    timeout:<span class="number">10000</span></span><br><span class="line">&#125;;</span><br><span class="line">myRequest(options,<span class="function"><span class="keyword">function</span>(<span class="params">err,res,body</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err || res.statusCode!==<span class="number">200</span>)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;种子页面爬取失败~&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> html=myIconv.decode(body,myEncoding);</span><br><span class="line">    <span class="keyword">var</span> $=myCheerio.load(html,&#123;<span class="attr">decodeEntities</span>:<span class="literal">false</span>&#125;);</span><br><span class="line">    <span class="keyword">var</span> newsDiv=$(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    newsDiv.each(<span class="function"><span class="keyword">function</span>(<span class="params">i,e</span>)</span>&#123;</span><br><span class="line">        news_url=get_news_url(e);</span><br><span class="line">        <span class="keyword">if</span> (newsExg.test(news_url))&#123;</span><br><span class="line">            check(news_url);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_news_url</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $_=myCheerio.load(e,&#123;<span class="attr">decodeEntities</span>:<span class="literal">false</span>&#125;);</span><br><span class="line">    <span class="keyword">var</span> news_url=$_(<span class="string">&#x27;a&#x27;</span>).attr(<span class="string">&#x27;href&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (news_url===<span class="string">&quot;javascript:void(0)&quot;</span>||news_url===<span class="literal">undefined</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (news_url.startsWith(<span class="string">&quot;http://&quot;</span>))</span><br><span class="line">        news_url=news_url;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">if</span> (news_url.startsWith(<span class="string">&quot;//&quot;</span>))</span><br><span class="line">            news_url=<span class="string">&quot;http:&quot;</span>+news_url;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span> (news_url.startsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">                news_url=myURL.slice(<span class="number">0</span>,-<span class="number">1</span>)+news_url;</span><br><span class="line">    <span class="keyword">return</span> news_url;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">news_url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> sel_sql=<span class="string">&quot;SELECT url from news where url=? &quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> sel_sql_params=[news_url];</span><br><span class="line">    mysql.query(sel_sql,sel_sql_params,<span class="function"><span class="keyword">function</span>(<span class="params">err,vals,fields</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;检索url错误~&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (vals.length&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;url重复访问~&quot;</span>);</span><br><span class="line">            ret=<span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> get_news(news_url);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_news</span>(<span class="params">news_url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> options=&#123;</span><br><span class="line">        url:news_url,</span><br><span class="line">        encoding:<span class="literal">null</span>,</span><br><span class="line">        timeout:<span class="number">10000</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> info=&#123;</span><br><span class="line">        title:<span class="string">&#x27;&#x27;</span>,<span class="attr">resource</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">author</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">content</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        keywords:<span class="string">&#x27;&#x27;</span>,<span class="attr">pubtime</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">fetchtime</span>:<span class="string">&#x27;&#x27;</span>,<span class="attr">url</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    myRequest(options,<span class="function"><span class="keyword">function</span>(<span class="params">err,res,body</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err || res.statusCode!==<span class="number">200</span>)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;新闻页面爬取失败~&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">var</span> html=myIconv.decode(body,myEncoding);</span><br><span class="line">        <span class="keyword">var</span> $=myCheerio.load(html,&#123;<span class="attr">decodeEntities</span>:<span class="literal">false</span>&#125;);</span><br><span class="line">        info.title=get_title($);</span><br><span class="line">        info.resource=get_resource();</span><br><span class="line">        info.author=get_author($);</span><br><span class="line">        info.content=get_content($);</span><br><span class="line">        info.keywords=get_keywords($);</span><br><span class="line">        info.pubtime=get_pubtime($);</span><br><span class="line">        info.fetchtime=get_fetchtime();</span><br><span class="line">        info.url=get_url(news_url);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;信息整理完毕~&quot;</span>);</span><br><span class="line">        Insert_into_sql(info);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_title</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> title=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    title=$(<span class="string">&#x27;title&#x27;</span>).text();</span><br><span class="line">    <span class="keyword">var</span> tmp=title.substring(title.indexOf(<span class="string">&#x27;-中新网&#x27;</span>));</span><br><span class="line">    title=title.replace(tmp,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> title;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_resource</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> resource=myResource;</span><br><span class="line">    <span class="keyword">return</span> resource;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_author</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> author=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    author=$(<span class="string">&quot;#author_baidu&quot;</span>).text();</span><br><span class="line">    author=author.substring(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> author;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_content</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> content=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    content=$(<span class="string">&#x27;div.left_zw&#x27;</span>).children(<span class="string">&#x27;p&#x27;</span>).text();</span><br><span class="line">    content=content.replace(<span class="regexp">/[\n\t\s\t]/g</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> content;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_keywords</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> key=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    key=$(<span class="string">&#x27;meta[name=keywords]&#x27;</span>).attr(<span class="string">&#x27;content&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_pubtime</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> pubtime=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    pubtime=$(<span class="string">&#x27;div.left-t&#x27;</span>).text();</span><br><span class="line">    <span class="keyword">var</span> tmp=pubtime.substring(pubtime.indexOf(<span class="string">&quot;来源&quot;</span>));</span><br><span class="line">    pubtime=pubtime.replace(tmp,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    pubtime=pubtime.replace(<span class="regexp">/\s/g</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    pubtime=pubtime.replace(<span class="regexp">/[年月日:]/g</span>,<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> pubtime;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_fetchtime</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fetchtime=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    fetchtime=<span class="keyword">new</span> <span class="built_in">Date</span>().toFormat(<span class="string">&quot;YYYY-MM-DD-HH-MM-SS&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> fetchtime;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_url</span>(<span class="params">news_url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> url=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    url=news_url;</span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Insert_into_sql</span>(<span class="params">info</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> add_sql=<span class="string">&quot;INSERT INTO news(id,title,resource,author,content,keywords,pubtime,fetchtime,url)VALUES(0,?,?,?,?,?,?,?,?)&quot;</span></span><br><span class="line">    <span class="keyword">var</span> add_sql_params=[info.title,info.resource,info.author,info.content,info.keywords,info.pubtime,info.fetchtime,info.url];</span><br><span class="line">    mysql.query(add_sql,add_sql_params,<span class="function"><span class="keyword">function</span>(<span class="params">qerr,vals,fields</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(qerr)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;新闻插入失败~&quot;</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(qerr.message,info);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;新闻插入成功~&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>前端：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        body&#123;</span><br><span class="line">            background-color: cornflowerblue;</span><br><span class="line"><span class="css">            <span class="selector-tag">margin-left</span><span class="selector-pseudo">:30px</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">margin-right</span><span class="selector-pseudo">:30px</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">border</span><span class="selector-pseudo">:3px</span> <span class="selector-tag">white</span> <span class="selector-tag">solid</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        <span class="selector-tag">view</span><span class="selector-class">.title</span>&#123;</span></span><br><span class="line">            color: white;</span><br><span class="line">            font-size: 25px;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: center;</span><br><span class="line">        &#125;</span><br><span class="line">        form&#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: center;</span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:white</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        <span class="selector-tag">form</span> <span class="selector-tag">input</span><span class="selector-class">.search</span>&#123;</span></span><br><span class="line">            width: 400px;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-class">.cardLayout</span>&#123;</span></span><br><span class="line">            color: white;</span><br><span class="line">        &#125;</span><br><span class="line">        table&#123;</span><br><span class="line"><span class="css">            <span class="selector-tag">padding</span><span class="selector-pseudo">:80px</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">border</span><span class="selector-pseudo">:2px</span> <span class="selector-tag">solid</span> <span class="selector-tag">white</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">        th&#123;</span><br><span class="line">            font-size: 20px;</span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:white</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">border</span><span class="selector-pseudo">:2px</span> <span class="selector-tag">solid</span> <span class="selector-tag">white</span>;</span></span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line">        td&#123;</span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:white</span>;</span></span><br><span class="line">            width: 10%;</span><br><span class="line">            height: 80px;</span><br><span class="line"><span class="css">            <span class="selector-tag">border</span><span class="selector-pseudo">:2px</span> <span class="selector-tag">solid</span> <span class="selector-tag">white</span>;</span></span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery/3.4.1/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&#x27;title&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>近期新闻内容整合搜索<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">        请输入关键词：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;search&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;search_title&quot;</span> <span class="attr">value</span>=<span class="string">&quot;搜索&quot;</span>&gt;</span></span><br><span class="line">        搜索范围：</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;option1&quot;</span>&gt;</span>标题</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;option2&quot;</span>&gt;</span>关键字</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;option3&quot;</span>&gt;</span>内容</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;option4&quot;</span>&gt;</span>根据日期排序</span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cardLayout&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">id</span>=<span class="string">&quot;record2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">&#x27;input.search_title&#x27;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">              <span class="keyword">var</span> title=$(<span class="string">&#x27;input.option1&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>);</span></span><br><span class="line"><span class="javascript">              <span class="keyword">var</span> keywords=$(<span class="string">&#x27;input.option2&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>);</span></span><br><span class="line"><span class="javascript">              <span class="keyword">var</span> content=$(<span class="string">&#x27;input.option3&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>);</span></span><br><span class="line"><span class="javascript">              <span class="keyword">if</span> (title.valueOf()==<span class="literal">false</span> &amp;&amp; keywords.valueOf()==<span class="literal">false</span> &amp;&amp; content.valueOf()==<span class="literal">false</span>)</span></span><br><span class="line">              &#123;</span><br><span class="line"><span class="javascript">                alert(<span class="string">&quot;请至少选择一项作为搜索范围~&quot;</span>);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span>;</span></span><br><span class="line">              &#125;</span><br><span class="line"><span class="javascript">              <span class="keyword">var</span> sort=$(<span class="string">&#x27;input.option4&#x27;</span>).is(<span class="string">&quot;:checked&quot;</span>);</span></span><br><span class="line"><span class="javascript">              <span class="keyword">var</span> words=$(<span class="string">&#x27;input.search&#x27;</span>).val();</span></span><br><span class="line"><span class="javascript">              $.get(<span class="string">&#x27;/process_get?title=&#x27;</span>+title+<span class="string">&#x27;&amp;keywords=&#x27;</span>+keywords+<span class="string">&#x27;&amp;content=&#x27;</span>+content+<span class="string">&#x27;&amp;sort=&#x27;</span>+sort+<span class="string">&#x27;&amp;words=&#x27;</span>+words, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    $(<span class="string">&quot;#record2&quot;</span>).empty();</span></span><br><span class="line"><span class="handlebars"><span class="xml">                    $(&quot;#record2&quot;).append(&#x27;<span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">&quot;cardLayout&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>新闻编号<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span>&#x27; +</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">                        &#x27;<span class="tag">&lt;<span class="name">th</span>&gt;</span>关键字<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>链接<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>来源<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>日期<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>&#x27;);</span></span></span><br><span class="line"><span class="javascript">                    <span class="keyword">for</span> (<span class="keyword">let</span> list <span class="keyword">of</span> data) &#123;</span></span><br><span class="line"><span class="javascript">                        <span class="keyword">let</span> table = <span class="string">&#x27;&lt;tr class=&quot;cardLayout&quot;&gt;&#x27;</span>;</span></span><br><span class="line"><span class="javascript">                        <span class="built_in">Object</span>.values(list).forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                            table += (<span class="string">&#x27;&lt;td&gt;&#x27;</span>+element + <span class="string">&#x27;&lt;/td&gt;&#x27;</span>);</span></span><br><span class="line">                        &#125;);</span><br><span class="line"><span class="javascript">                        $(<span class="string">&quot;#record2&quot;</span>).append(table + <span class="string">&#x27;&lt;/tr&gt;&#x27;</span>);</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>后端：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"><span class="keyword">var</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;../mysql.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page. */</span></span><br><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.render(<span class="string">&#x27;index&#x27;</span>, &#123; <span class="attr">title</span>: <span class="string">&#x27;Express&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&#x27;/process_get&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//sql字符串和参数</span></span><br><span class="line">    <span class="keyword">var</span> fetchSql = <span class="string">&quot;select id,title,keywords,url,resource,pubtime &quot;</span> + <span class="string">&quot;from news where&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> conc=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (request.query.title==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; title like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (request.query.keywords==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; keywords like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (request.query.content==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; content like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (request.query.sort==<span class="string">&quot;true&quot;</span>)&#123;</span><br><span class="line">        fetchSql+=<span class="string">&quot; order by pubtime ASC&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fetchSql+=<span class="string">&quot;;&quot;</span>;</span><br><span class="line">    mysql.query(fetchSql, <span class="function"><span class="keyword">function</span>(<span class="params">err, result, fields</span>) </span>&#123;</span><br><span class="line">        response.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        response.write(<span class="built_in">JSON</span>.stringify(result));</span><br><span class="line">        response.end();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">&#x27;/process_get_inorder&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//sql字符串和参数</span></span><br><span class="line">    <span class="keyword">var</span> fetchSql = <span class="string">&quot;select id,title,keywords,url,resource &quot;</span> + <span class="string">&quot;from news where&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> conc=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (request.query.title)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; title like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (request.query.keywords)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; keywords like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (request.query.content)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!conc)&#123;</span><br><span class="line">            conc=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> fetchSql+=<span class="string">&quot; or&quot;</span></span><br><span class="line">        fetchSql+=<span class="string">&quot; content like &#x27;%&quot;</span>+request.query.words + <span class="string">&quot;%&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fetchSql+=<span class="string">&quot;;&quot;</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(fetchSql);</span><br><span class="line">    fetchSql=<span class="string">&quot;select id,title,keywords,url,resource from news where title like &#x27;%新冠%&#x27; or keywords like &#x27;%新冠%&#x27; or content like &#x27;%新冠%&#x27;;&quot;</span>;</span><br><span class="line">    mysql.query(fetchSql, <span class="function"><span class="keyword">function</span>(<span class="params">err, result, fields</span>) </span>&#123;</span><br><span class="line">        response.writeHead(<span class="number">200</span>, &#123;</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        response.write(<span class="built_in">JSON</span>.stringify(result));</span><br><span class="line">        response.end();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/nodejs/" rel="tag"># nodejs</a>
          
            <a href="/tags/web/" rel="tag"># web</a>
          
            <a href="/tags/%E4%BD%9C%E4%B8%9A/" rel="tag"># 作业</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/04/19/%E4%B8%80%E4%B8%AA%E7%BB%86%E8%87%B4%E5%85%A5%E5%BE%AE%E7%9A%84nodejs%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%EF%BC%88%E4%B8%8A%EF%BC%89/" rel="next" title="一个nodejs爬虫项目介绍（上）">
                <i class="fa fa-chevron-left"></i> 一个nodejs爬虫项目介绍（上）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/06/06/Web%E7%BC%96%E7%A8%8B%E5%A4%A7%E4%BD%9C%E4%B8%9A(%E4%B8%80)%E6%A0%91%E8%8E%93%E6%B4%BE%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE,Wifi%E6%90%AD%E5%BB%BA/" rel="prev" title="Web编程大作业(一)树莓派环境配置,Wifi搭建">
                Web编程大作业(一)树莓派环境配置,Wifi搭建 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives%7C%7Carchive">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友链
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://helloat123.github.io" title="Richard" target="_blank">Richard</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://qwqbot.com" title="qwqbot" target="_blank">qwqbot</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87%E7%A8%8B"><span class="nav-number">2.</span> <span class="nav-text">过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">3.</span> <span class="nav-text">1. MySQL数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-MySQL%E7%BB%93%E6%9E%84"><span class="nav-number">3.1.</span> <span class="nav-text">1.1 MySQL结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E6%8F%92%E5%85%A5%E4%BF%A1%E6%81%AF"><span class="nav-number">3.2.</span> <span class="nav-text">1.2 插入信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95%EF%BC%88%E7%AD%9B%E9%80%89%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E7%BB%9F%E8%AE%A1%EF%BC%89"><span class="nav-number">3.3.</span> <span class="nav-text">1.3 操作方法（筛选、排序、统计）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA"><span class="nav-number">4.</span> <span class="nav-text">2. 网站搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-express%E6%A1%86%E6%9E%B6%E4%B8%80%E7%82%B9%E7%AE%80%E5%8D%95%E7%9A%84%E8%AE%A4%E8%AF%86"><span class="nav-number">4.1.</span> <span class="nav-text">2.1 express框架一点简单的认识</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-html%E5%B5%8C%E5%85%A5js%E4%BB%A3%E7%A0%81"><span class="nav-number">5.</span> <span class="nav-text">2.2 html嵌入js代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E4%BD%BF%E7%94%A8express%E6%A1%86%E6%9E%B6"><span class="nav-number">6.</span> <span class="nav-text">2.3 使用express框架</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E5%9D%91%E5%92%8C%E6%89%A9%E5%B1%95"><span class="nav-number">7.</span> <span class="nav-text">一些坑和扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81"><span class="nav-number">7.1.</span> <span class="nav-text">MySQL中文乱码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E9%80%89%E6%90%9C%E7%B4%A2%E8%8C%83%E5%9B%B4"><span class="nav-number">7.2.</span> <span class="nav-text">可选搜索范围</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E6%8E%92%E5%BA%8F"><span class="nav-number">7.3.</span> <span class="nav-text">日期排序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E7%BB%88%E6%95%88%E6%9E%9C%E3%80%81%E4%BB%A3%E7%A0%81"><span class="nav-number">8.</span> <span class="nav-text">最终效果、代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">9.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yunfan Li</span>

  
</div>
<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>

-->

<!-- 不蒜字统计 -->
<div>
	<i class="fa fa-user-md"></i>
	<span id="busuanzi_container_site_uv">
	  访问人数：<span id="busuanzi_value_site_uv"></span>
	</span>&nbsp;|&nbsp;
	
	<i class="fa fa-eye"></i>
	<span id="busuanzi_container_site_pv">
	  总访问量：<span id="busuanzi_value_site_pv"></span>
	</span>&nbsp;|&nbsp;
	
	<!-- 添加博客全站总字数统计-->
	<i class="fa fa-pencil"></i>
	<span class="post-count">博客全站共 68.6k 字</span>
</div>



        
<div class="busuanzi-count">
  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>

  

  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
